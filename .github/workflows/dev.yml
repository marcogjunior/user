name: Dev Pipeline

on:
  push:
    branches: [ dev ]

jobs:
  
   ci:
    name: Build and run test in Development
    uses: ./.github/workflows/ci.yml
    with:
      environment: dev
   docker:
      name: Build and push image
      needs: ci
      uses: ./.github/workflows/docker-build-push.yml
      
      with:
        branch: main
        image_name: user-api
        environment: development
      secrets:
        DOCKER_USERNAME: ${{ secrets.DOCKER_USERNAME }}
        DOCKER_PASSWORD: ${{ secrets.DOCKER_PASSWORD }}